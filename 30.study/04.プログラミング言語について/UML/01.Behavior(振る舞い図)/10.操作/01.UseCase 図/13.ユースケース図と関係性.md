# Relationship

* ユースケース図における関係性には5種類ある

## Association between an actor and a use case

* Actor は少なくとも1つのユースケースと紐付いていなければならない
* Actor は複数のユースケースと紐づくことができる
* 複数のActorが単一のユースケースと紐づくことができる

```PlantUML
@startuml

顧客 -> (口座開設)

(口座開設) <- 銀行員
顧客 -> (定期預金)

@enduml
```

## Generalization of an actor

* Actor の 汎化は、あるアクターは別のアクターからロールを継承できるということ

* 継承する側は、親アクターのすべてのユースケースを継承する

* 継承したアクターは、そのロール固有のユースケースを一つ以上持つ


```PlantUML
@startuml
顧客 -> (口座開設)

(口座開設) <- 銀行員
顧客 -> (定期預金)


顧客 <|-- ゆうちょ銀行の顧客
ゆうちょ銀行の顧客 -> (切手購入)
@enduml
```
## Extend relationship between two use cases
* ベースユースケースを拡張して、システムに機能を追加する
* 拡張するユースケースは、ベースのユースケースに依存する
* 下記図の中では、預金ユースケースの存在がないと、ボーナス計算ユースケースの意味がよくわからんくなる
* The extending ユースケースは通常オプション。条件によってトリガーされたりする
* 下記図の例では、預金が 10000 を超えたか、年齢が 55 を超えた場合のみトリガーされる
* 手数料は、残高引き出しを extend したものになる
* 手数料発生の場合、ATM のオーナーである銀行に口座がない場合のみ発生する、などの条件

* ベースユースケースは、それ自体で意味があるものでなければならない
* それ自体で独立しており、拡張したユースケースの振る舞いに依存しない


```PlantUML
@startuml

顧客 -> (口座開設)

(口座開設) <- 銀行員
顧客 -> (預金)
(預金) <.. (ボーナス計算) : extends


note "預金が 10000 を超えた\n または \n 年齢が 55 を超えた" as nbonus
(預金) .. nbonus
nbonus .. (ボーナス計算)


顧客 <|-- ゆうちょ銀行の顧客
ゆうちょ銀行の顧客 -> (切手購入)
@enduml
```

# Include relationship between two use cases
* 複数のユースケースで共通するユースケースの断片を外だししたもの
* Include されたユースケースは、それ単体では存在できない
* Include のベースユースケースは、Include されたユースケースなしでは不完全
* 冗長が顕著である場合のみ、Include として表現するべき
* たまたまかぶった、ではなく、設計によってそうなる場合のみ、Include を使うべし
* 例えば、ATMを使うときのフローにかならず発生するイベント(暗証番号入力)など



```PlantUML
@startuml

actor 顧客
actor 銀行員

顧客 -> (口座開設)

(口座開設) <- 銀行員
顧客 -> (預金)
顧客 -> (預金引き出し)
(預金) <.. (ボーナス計算) : extends
(預金) ..>(残高更新): include
(預金引き出し) ..>(残高更新): include


note "預金が 10000 を超えた\n または \n 年齢が 55 を超えた" as nbonus
(預金) .. nbonus
nbonus .. (ボーナス計算)


顧客 <|-- ゆうちょ銀行の顧客
ゆうちょ銀行の顧客 -> (切手購入)
@enduml
```




# Generalization of a use case
* アクターの汎化と似ている
* 祖先の振る舞いは子孫に継承される

* 2つのユースケースに共通する振る舞いがあり、かつ、各ユースケースに固有の振る舞いがあるときに使われる

* (代金を払う) の場合、クレジットカードで払う、または銀行手形で払うというふうに 汎化できる
