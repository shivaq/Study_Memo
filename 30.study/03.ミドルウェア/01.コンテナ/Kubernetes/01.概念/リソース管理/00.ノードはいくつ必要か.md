# 最初の試算
- トラディショナルなサーバでそのアプリを動かす場合、何台必要か、と考えてみる
- 10台必要だとしても、そんなにK82ならそんなにいらない、ということは言える

## The smallest cluster
- 開発段階なら、ノード一つで実験できる
- ノード一つだと冗長構成をテストできない

## マスターノードはいくつ必要か
- GKE の場合はマスターノードを用意する必要はない
- マスターノードを自分で用意しなければならない場合。。。
- 最低3つのマスターノードが必要。2つだと、どちらがリーダーノードになるかが合意できない可能性がある
- それでも少なすぎる
- Worker ノードを追加して、Control Plane と競合しないようにするのが望ましい(マスターとワーカーとが同一ノードじゃないほうがいい、という意味？)
- ノードの数が大きくなればなるほど、マスターノードの負荷が増える
- ノード数の制限は最大5000、Podは 15000、コンテナは300000

## ワーカーノードはいくつ必要か
- 最低2つ。3つだとよりよい。

# AutoScaling は必要なときだけ使うように
- Workload や需要の変化が大きい場合に限り、使いましょう。そうじゃなきゃたぶん不要
- とりあえずあるし、使っとこか。。。はよくない
- 需要がどのように変化するか、といった感覚をつかめるようになるまでは、クラスタは手動でスケールさせればよい



## インスタンスのサイズはどれくらいがよいか

- 高可用性のために 10ノード必要だとする
- 各ノードの Pod は少ないとする
- ノードのインスタンスは小さくできる
- ノードは2つだけあればよいとする
- インスタンスを大きくする余地がある


## インスタンスタイプはどれがよいか
- kubelet などなどがそれなりのリソースを必要とするため、プロバイダの最小タイプでは足りない

- 5ノードくらいの小さなクラスタのマスターノードの場合
- 1 vCPU 3-4 GiB
- n1-standard-1 instance on Google Cloud, an m3.medium on AWS, and a Standard DS1 v2 on Azure.

- ワーカーノードの場合、最低でも 1 vCPU 4 GiB (n1- standard-1)
- 2,30ノードのクラスタの場合、2,3 の異なるインスタンスサイズをプロビジョンするのが妥当
- 処理能力が必要な Workloa には、スペックの高いノードに割り振る
- 小さなノードは小さなPodで使わせる(Affinity を使って)



# Instance groups
- GKE の場合、node pools という同じインスタンスタイプでグループ化したインスタンスグループという概念がある
- ノードプールはグループのmax, min サイズやインスタンスタイプを変えることで、スケールできる


